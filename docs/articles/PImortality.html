<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using ExcessILI with US P&amp;I mortality data â€¢ ExcessILI</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using ExcessILI with US P&amp;I mortality data">
<meta property="og:description" content="ExcessILI">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ExcessILI</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ESSENCE.html">Going from line list data to an interactive app</a>
    </li>
    <li>
      <a href="../articles/ILINet.html">Using ExcessILI with ILINet</a>
    </li>
    <li>
      <a href="../articles/PImortality.html">Using ExcessILI with US P&amp;I mortality data</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using ExcessILI with US P&amp;I mortality data</h1>
                        <h4 class="author">Dan Weinberger</h4>
            
            <h4 class="date">4/3/2020</h4>
      
      
      <div class="hidden name"><code>PImortality.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><html><body><pre class="r">library(ExcessILI)
library(cdcfluview)
#&gt; Warning: package 'cdcfluview' was built under R version 3.6.3
library(reshape2)
library(ggplot2)
#&gt; Warning: package 'ggplot2' was built under R version 3.6.3
library(RColorBrewer)
library(plotly)
#&gt; 
#&gt; Attaching package: 'plotly'
#&gt; The following object is masked from 'package:ggplot2':
#&gt; 
#&gt;     last_plot
#&gt; The following object is masked from 'package:stats':
#&gt; 
#&gt;     filter
#&gt; The following object is masked from 'package:graphics':
#&gt; 
#&gt;     layout
library(MMWRweek)
#&gt; Warning: package 'MMWRweek' was built under R version 3.6.3</pre></body></html></div>
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>The goal for this package is to facilitate the formatting of line list data from syndromic surveillance datasets into time series and then the analysis of these data to detect increases above the seasonal baseline. For US data, there is an option to automatically adjust the data for state-specific flu activity (using data from <a href="https://www.cdc.gov/surveillance/nrevss/index.html">NREVSS</a> and/or state-specific RSV activity (based on Google search volume). The user can either start with line list data or formatted time series data</p>
<p>In this example, we will analyze <a href="https://wwwn.cdc.gov/ILINet/">ILINet</a> data with a simple seasonal baseline, adjusting for flu and year-to-year variations. The model is fit through end-of-February 2020 and then extrapolated forward based on the time of year and the amount of influenza activity. Influenza activity is captured by using the proportion of tests that were positive from the NREVSS system (log transformed in model)</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r">## Download the mortality data

pi.data </pre></body></html></div>
<div class="sourceCode" id="cb3"><html><body><pre class="r">#Format and fill mssings with 0s

pi.data$state </pre></body></html></div>
<div class="sourceCode" id="cb4"><html><body><pre class="r">#Run analysis
excess_deaths1.adjusted  [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"
#&gt; [1] "epiyr.index.f + sin1 + cos1 + sin2 + cos2 + sin3 + cos3"</pre></body></html></div>
</div>
<div id="plot-observed-weekly-death-rate-vs-baseline" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-observed-weekly-death-rate-vs-baseline" class="anchor"></a>Plot observed weekly death rate vs baseline</h2>
<div class="sourceCode" id="cb5"><html><body><pre class="r">### Extract the quantities of interest

#Which syndrome do you want to plot, and over what time range?

syndrome.select </pre></body></html></div>
<div class="sourceCode" id="cb6"><html><body><pre class="r">#Extract the data needed to plot from the results

dates1 </pre></body></html></div>
<p>Generate the plots</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r">n.days </pre></body></html></div>
<div class="sourceCode" id="cb8"><html><body><pre class="r">
  par(mfrow=c(4,4))

for(i in 1:dim(pred)[2]){
  for(j in 1:dim(pred)[3]){
    y.range1</pre></body></html></div>
<p><img src="PImortality_files/figure-html/unnamed-chunk-9-1.png" width="768"><img src="PImortality_files/figure-html/unnamed-chunk-9-2.png" width="768"><img src="PImortality_files/figure-html/unnamed-chunk-9-3.png" width="768"> ## Observed/expected</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r">
  par(mfrow=c(4,4))

for(i in 1:dim(pred)[2]){
    y.range1</pre></body></html></div>
<p><img src="PImortality_files/figure-html/unnamed-chunk-12-1.png" width="768"><img src="PImortality_files/figure-html/unnamed-chunk-12-2.png" width="768"><img src="PImortality_files/figure-html/unnamed-chunk-12-3.png" width="768"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Daniel Weinberger, Marcus Russi.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
